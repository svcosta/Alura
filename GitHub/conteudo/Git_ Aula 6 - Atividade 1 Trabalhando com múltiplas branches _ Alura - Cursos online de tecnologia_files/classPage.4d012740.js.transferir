var Task=function(){function a(a){return{"task.id":a.data("task-id"),"answer.author.id":a.data("author-id")}}function b(){var a=$(".task-feedback"),b=$("#task-content .task-actions"),c=$(".markdownEditor, .openQuestion-answer-title");$(".task-actions").show(),a.length>0&&(b.addClass("screenReader-only"),$(".screenReader-only .task-actions-button-forum").hide(),c.length>0&&c.hide(),a.addClass("task-feedback--visible"),a.attr("aria-hidden","false"),sticky&&sticky.recalc()),e()}function c(a,b,c){var d=document.open("text/html","replace");d.write(a.responseText),d.close()}function d(){var a=$(".task-body-actions-button.task-actions-button-answer");a.addClass("task-actions-button-spinning"),a.prop("disabled",!0)}function e(){var a=$(".task-body-actions-button.task-actions-button-answer");a.removeClass("task-actions-button-spinning"),a.prop("disabled",!1)}function f(){$(".choiceable-opinion").css("display","block")}function g(e,g){h.data("hasfeedbackanswer")||d();var l=a(h),m=$(".repetition");if(m[0]&&(i=m.data("repeatable-type"),j=h.data("course-code"),k=h.data("section-number"),l=a(m),l["answer.fromRepetition"]=!0),"singlechoice"==i){var n=$(".alternativeList-item-input:checked");l.alternativeId=n.attr("id"),f()}else if("multiplechoice"==i){var o=$(".alternativeList-item-input:checked");o.each(function(a){l["answer.alternatives["+a+"].id"]=$(this).attr("id")}),f()}else if("openquestion"==i)l["answer.answeredText"]=$(".markdownEditor-textArea").val();else if("fillintheblank"==i){var p=$(".phrase-input").val();l["answer.answeredText"]=p}else"speakingpractice"!=i&&"pronunciationpractice"!=i||(l["answer.feedback"]=g);var q=h.data("url-prefix");$.ajax({type:"POST",url:q+"course/"+j+"/section/"+k+"/"+i+"/answer",data:l,success:e||b,statusCode:{400:e||b,500:c}})}var h=$(".task"),i=h.data("task-type"),j=h.data("course-code"),k=h.data("section-number");return{submitAnswer:g,showOpinionIfAvailable:b,toggleChoiceableOpinion:f,enableButton:e}}(),Choiceable=function(){function a(){$(".alternativeList-item-opinionButton").on("click",function(a){a.preventDefault(),$(this).parents("li").toggleClass("alternativeList-item--active"),Aria.expandingButton($(this))})}function b(a){a&&$("#task-content").attr("data-should-submit-answer",!1)}function c(a){return a.hasClass("alternativeList-item--checked")}function d(a){return a.target.classList.contains("alternativeList-item-opinionIcon-use")||a.target.classList.contains("alternativeList-item-opinionIcon")}function e(){$(".alternativeList-item--checked").each(function(){var a=$(this);if(a.find(".alternativeList-item-opinionIcon").length>0){a.addClass("alternativeList-item--active");var b=a.find(".alternativeList-item-opinionButton");Aria.expandingButton(b)}a.data("correct")?$(".singleChoice-alternative-aria-feedback").text("Alternativa correta"):$(".singleChoice-alternative-aria-feedback").text("Alternativa incorreta")}),sticky.recalc()}function f(){$(".alternativeList-item-opinionButton").each(function(){var a=$(this)[0];a.classList.contains("alternativeList-item-opinionButton--visible")||a.classList.add("alternativeList-item-opinionButton--visible")}),$(".task-actions").css("display","block"),$(".task-actions-button-next").css("display","inline-block"),sticky.recalc()}function g(a){a.toggleClass("alternativeList-item--checked")}function h(){$(".alternativeList-item-input").each(function(){$(this).attr("disabled","true")}),$(".alternativeList-item-span").addClass("alternativeList-item-span-disabled")}function i(){var a=$("[data-amplitude]").data().amplitude;track(a)}return{setup:a,updateSubmitAnswerIf:b,isChecked:c,isOpinionIcon:d,showAlternativeOpinionsAndNextButton:f,toggleLabelClass:g,showAlternativeOpinions:e,disableAllAlternatives:h,showAlternativeOpinionsAndNextButton:f,submitAmplitudeTaskAnswered:i}}();!function(){function a(){var a="gnarus.menuClosed="+e.hasClass("menu--inactive")+"; path=/; domain="+f;document.cookie=a}function b(){return h||void 0!=d&&d.getValue()!=c}var c,d,e=$(".task"),f=e.data("domain"),g=$(".openMenu-button"),h=!1,i=!1;$(".task-menu-button, .task-body-button").on("click",function(b){b.stopPropagation(),e.toggleClass("menu--inactive"),g.toggleClass("openMenu-button--inactive"),a(),sticky.recalc()}),$(".task-submit").on("click",function(a){$(".task-body-main").data("should-warn")&&b()&&!i&&(0==window.confirm("Suas alterações ainda não foram salvas, clique em Responder para salvá-las. Deseja ir para a próxima aula?")&&a.preventDefault())}),$(".markdownEditor-textArea, .phrase-input").on("change",function(){h=!0}),$(".task-actions-button-answer").on("click",function(){i=!0}),$(document).click(function(b){$(window).width()<768&&($(b.target).closest(".task-menu-button").length||$(b.target).closest(".task-menu").length||$(b.target).closest(".settings-box").length||(e.addClass("menu--inactive"),g.addClass("task-menu-button--inactive"),a()))}),$(".task-menu-section-title,.task-menu-nav,.task-menu-sections").on("click",function(a){e.removeClass("menu--inactive"),g.removeClass("task-menu-button--inactive")}),$(".settings-button").on("click",function(a){a.stopPropagation(),$(this).toggleClass("settings-button--active")}),$("html").click(function(){$(".settings-button").removeClass("settings-button--active")}),$(window).load(function(){$(".alternativeList-item--checked").size()>0&&(Task.toggleChoiceableOpinion(),Choiceable.showAlternativeOpinions(),Choiceable.showAlternativeOpinionsAndNextButton())}),$(".task-actions-button-answer").on("click",function(){$(this).attr("aria-expanded","true")}),$("[data-submittable=true]").on("click",function(){Task.submitAnswer()}),$(".task-actions-button-showOpinion").on("click",function(){Task.showOpinionIfAvailable()}),$(".task-actions-button-forum").on("click",function(){var a=$(this).data("amplitude-onsubmit");track(a)})}();var sticky=function(){function a(){d&&(f=d.getBoundingClientRect().height,g=window.innerHeight,h=e.getBoundingClientRect().height)}function b(){var a=window.scrollY||window.pageYOffset;if(!(i==a||a<0)){if(!(a>document.documentElement.offsetHeight-g)){var b=Math.max(Math.min(j+a-i,f-g),0);isNaN(b)||(b!=j&&(d.style.transform="translateY("+-b+"px)",j=b),i=a)}}}function c(){d&&(f>h||window.innerWidth<=691?d.style.position="absolute":(d.style.position="fixed",b()),requestAnimationFrame(c))}var d=document.querySelector(".task-menu"),e=document.querySelector(".task-body");if(!(("scrollY"in window||"pageYOffset"in window)&&"requestAnimationFrame"in window))return void(d.style.position="absolute");var f,g,h;window.addEventListener("resize",a),setTimeout(a,0),setTimeout(a,200);var i=window.scrollY||window.pageYOffset,j=0;return requestAnimationFrame(c),{recalc:a}}();